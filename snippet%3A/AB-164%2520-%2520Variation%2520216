document.documentElement.dataset.webAb164 = "1";

window.addEventListener('load', () => {

    const productGrid = document.querySelector('product-grid');
    const productCards = document.querySelectorAll('cdx-card.card.ng-star-inserted');

    productCards.forEach(card => {
        const strapLine = card.querySelector('.productStrap-text');
        const priceWas = card.querySelector('.price--was');
        const priceSave = card.querySelector('.price--save');
        const fullPrice = priceWas && priceWas.textContent.match('\\$(.*)');
        const savedPrice = priceSave && priceSave.textContent.match('\\$(.*)');
        let strapLineText = '';

        if (!priceSave && !priceWas) {
            return;
        }

        if (priceSave && priceSave.textContent.startsWith('Save')) {
            strapLineText = priceSave.textContent;
        }

        const priceTags = card.querySelectorAll('.price--was');
        const presentPriceEl = card.querySelector('.presentPrice');
        const presentPrice = presentPriceEl.ariaLabel;
        const nonMemberPrice = priceTags[1] && priceTags[1].textContent.match('\\$(.*)');
        const price = presentPrice.match(/\$([\d.]+)/)[1];

        if (nonMemberPrice && price) {
            const saving = Number(nonMemberPrice[1]) - Number(price);
            strapLineText = `Save $${saving.toFixed(2)}`;
        }

        strapLine.textContent = strapLineText;

    });

}, false);