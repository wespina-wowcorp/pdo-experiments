document.documentElement.dataset.webAb164 = "1";

// window.addEventListener('load', () => {

const productGrid = document.querySelector('product-grid')
const productCards = document.querySelectorAll('cdx-card.card.ng-star-inserted');

productCards.forEach(card=>{
    const strapLine = card.querySelector('.productStrap-text');
    const priceWas = card.querySelector('.price--was');
    const priceSave = card.querySelector('.price--save');
    const fullPrice = priceWas && priceWas.textContent.match('\\$(.*)');
    const savedPrice = priceSave && priceSave.textContent.match('\\$(.*)');
    const previousPriceContainer = card.querySelector('.previousPrice');
    let strapLineText = '';

    let savingsText = '';

    if (!priceSave && !priceWas) {
        return;
    }

    // if (priceSave && priceSave.textContent.startsWith('Save')) {
    //     strapLineText = priceSave.textContent;
    // }

    const priceTags = card.querySelectorAll('.price--was');
    const presentPriceEl = card.querySelector('.presentPrice');
    const presentPrice = presentPriceEl.ariaLabel;
    const nonMemberPrice = priceTags[1] && priceTags[1].textContent.match('\\$(.*)');
    const price = presentPrice.match(/\$([\d.]+)/)[1];

    console.log('>>>>price ', price)

    if (nonMemberPrice && price) {
        const saving = Number(nonMemberPrice[1]) - Number(price);
        const newSavingsPriceEl = priceTags[1].cloneNode(true);
        savingsText = `Save $${saving.toFixed(2)}`;

        newSavingsPriceEl.classList.remove('price--was');
        newSavingsPriceEl.classList.add('price--save');
        newSavingsPriceEl.textContent = savingsText;

        previousPriceContainer.append(newSavingsPriceEl);
    }


}
)

// }, false);
